# Showing that the VC-dimension is \(\Sigma_3^P\)-complete


The **VC (Vapnikâ€“Chervonenkis) dimension** is a measure of complexity of a set of functions that can be learned by a simple binary classification algorithm. To define it more formally, we need the concept of *shattering*.

Given a collection \(S = S_1, ..., S_M\) of subsets of a finite set \(U\), the VC-dimension of \(S\) is the size of the largest set \(X \subseteq U\) such that for every \(X' \subseteq X\), there is an \(i\) for which \(S_i \cap X = X'\). For this \(i\), we can write that \(X\) is shattered by \(S\). So, a Boolean circuit \(C\) that computes a function \(f:\{0, 1\}^m \times \{0, 1\}^n \rightarrow \{0, 1\}\) succinctly represents a collection \(S\) of \(ğŸ^ğ’\) subsets of \(ğ‘¼ = \{0, 1\}^n\) as follows: the set \(S_i\) consists of exactly those elements \(x\) for which \(C(i, x) = ğŸ\).

Using this notion, the language **VC-DIMENSION** is the set of pairs \((C, k)\) for which \(C\) represents a collection of subsets \(S\) whose VC dimension is at least \(k\). The purpose of this blog post is to show that this language has an intricate relationship with the polynomial hierarchy in computational complexity. 

To explain this better, I'm going to introduce some notation: 

Let \(\text{P}^A\) be the set of problems solvable in poly-time with a TM that uses an oracle for a problem in \(A\).

Let \(\text{NP}^A\) be the set of problems solvable in nondeterministic poly-time with a TM that uses an oracle for a problem in \(A\).

Let \(\text{coNP}^A\) be the set of problems solvable in co-nondeterministic poly-time with a TM that uses an oracle for a problem in \(A\).

Then, define \(\Delta_0^P := \Sigma_0^P := \Pi_0^P:=P\), where \(P\) is the set of problems that can be solved in poly-time. Then, for all \(i \geq 0\), define:

$$\Delta_{i+1}^P:=\text{P}^{\Sigma_i^P}$$
$$\Sigma_{i+1}^P:=\text{NP}^{\Sigma_i^P}$$
$$\Pi_{i+1}^P:=\text{coNP}^{\Sigma_i^P}$$

The result that I want to show here is that the VC-dimension is in \(\Sigma_3^P\), and that is the strongest form of problem in \(\Sigma_3^P\). So, any solution that can compute the VC-dimension can be used to compute any other problem in \(\Sigma_3^P\). The complexity-theoretic word for this phenomenon is *completenesss*. That is to say, the V-dimension is \(\Sigma_3^P\)-complete.

## **Lemma 1: The size of the largest possible set \(X\) shattered by a collection of \(2^ğ‘š\) subsets is \(m\).** 

By definition, \(X\) being shattered by a collection of sets \(S\) means that \(\forall X' \subseteq X, \exists i s.t. S_ğ‘– \cap X = X'\). This is the same thing as writing that \(X\) is shattered by a collection of sets \(C\) if and only if $$P(ğ´) = \{X âˆ© S_i | S_i \in ğ¶\}$$ However, since a set of size \(m\) has a power set of size \(2^m\), no set of size \(> m\) will have \(2^m\) possible subsets (a set of size \(m + 1\) will have a power set of size \(2^{m+1} = 2 \cdot 2^ğ‘š > 2^ğ‘š\)). Therefore, a set \(X\) that is shattered by a collection of \(2^m\) subsets will have a size atmost \(m\). 

Hence, the largest possible \(X\) will have size \(m\).

## ** Lemma 2: Arguing that the VC-dimension is in \(\Sigma_3^P\). **
    
A Boolean circuit \(C\) that computes a function \(f: \{0, 1\}^m \times \{0, 1\}^n \to \{0, 1\}\) succinctly represents a collection \(s\) of \(2^m\) subsets of \(U = \{0, 1\}^n\). However, if the Boolean circuit represents \(2^m\) possible subsets, then (by lemma 1) the VC-DIMENSION of \(C\) is \(m\).

Note then that by definition:

$$\Sigma_3^P = \text{NP}^{\Sigma_2^P} = \text{NP}^{\text{NP}^{\Sigma_1^P}} = \text{NP}^{\text{NP}^{\text{NP}}}$$

Therefore, we can now define instances of the ğ‘‰ğ¶-dimension decision problem by phrasing the question as whether whether there is a â€œ\(\{(ğ¶, ğ‘š) \text{ s.t. } VC(C) \geq m\}\)â€?â€ where \(C\) is the collection of circuits which succinctly represent the collection of subsets \(S\).


The â€œyesâ€ instance (using the \(NP^{NP^{NP}}\) notation) of the VC-dimension problem would then be:

$$\text{VCâˆ’DIMENSION}=\{(ğ¶,ğ‘š): \exist X, X\geq m \text{ s.t. }\forall X' âŠ†ğ‘‹,\exist ğ‘–\text{ s.t. }S_i \cap ğ‘‹=ğ‘‹'\}$$

$$\text{VCâˆ’DIMENSION}=\{(ğ¶,ğ‘š):\exist X,|X|\geq m \text{ s.t. } \forall X' âŠ†ğ‘‹,\exist ğ‘–\text{ s.t. }\forall x\inX',C(i,x)=1\}$$

Since every certificate would also need a certificate which would in turn need a proof of membership (just by the nature of this representation), where \(i, X, X'\) are polynomially large in \(m\), the nondeterminism can just act on every subset knowing that each subset would be polynomially large since \(ğ‘ğ‘œğ‘™ğ‘¦ (ğ‘ğ‘œğ‘™ğ‘¦(ğ‘ğ‘œğ‘™ğ‘¦(ğ‘š))) \in ğ‘ğ‘œğ‘™ğ‘¦(ğ‘š)\).

Therefore, we can decide a language in polynomial time since atleast one of the (polynomially long) computation paths would lead to an â€œACCEPTâ€ state if it is a â€œyesâ€ instance and none of the (polynomially long) computation paths would lead to a â€œREJECTâ€ state if it is a â€œnoâ€ instance.

Therefore, we have that:

$$\text{VC-DIMENSION} \in \Sigma_3^P$$

QED.


## ** Lemma 3: Arguing that the VC-dimension is \(\Sigma_3^P\)-complete through a reduction from \(\mathrm{QSAT}_3\). **

Given an instance of VC-DIMENSION:

$$\text{VCâˆ’DIMENSION}=\{(ğ¶,ğ‘š):\exist X,|X|\geq m\text{ s.t. }\forall X' âŠ†ğ‘‹,\exist ğ‘–\text{ s.t. }\forall x\inX',C(i,x)=1\}$$

We can show that it is \(Î£_3ğ‘ƒ\)-complete by reducing from an instance of \(ğ‘„ğ‘†ğ´ğ‘‡_3\) which is known to be \(Î£_3^P\)-complete. Therefore, let an arbitrary instance of \(ğ‘„ğ‘†ğ´ğ‘‡_3\) be:
$$\exist ğ‘¥_1 \forall ğ‘¥_2 \exist ğ‘¥_3 \text{ s.t. } \varphi(ğ‘¥_1,ğ‘¥_2,ğ‘¥_3)=1$$

We then define the universe \(U\) as the set \(\{0, 1\}^\ell \times \{1, 2, 3, ... \ell\}\) s.t. \(\forall ğ‘¥_1, |ğ‘¥_1| = \ell\), we define the following subset:
$$ğ‘ˆ_{ğ‘¥_1} = \{ğ‘¥_1\} \times \{1,2,3,...\ell\}$$

Using this, we define the collection of sets, \(S\), succinctly represented by circuit \(C\) (note that the circuit would have to maintain this invariant \(\forall ğ‘¥_1,ğ‘¥_2,ğ‘¥_3\), as:

1) If \(\varphi(ğ‘¥_1,ğ‘¥_2,ğ‘¥_3)=1\), then \(ğ‘†(ğ‘¥_1,ğ‘¥_2,ğ‘¥_3)=\{ğ‘¥_1\}Ã—\{1,2,3,...\ell\},|ğ‘¥_1|=l\)
2) If \(\varphi(ğ‘¥_1, ğ‘¥_2, ğ‘¥_3) = 0\), then \(ğ‘†(ğ‘¥_1, ğ‘¥_2, ğ‘¥_3) = \phi\), where \(\phi\) is the empty set (note that we donâ€™t need to address this case here since \(\varphi(ğ‘¥_1,ğ‘¥_2,ğ‘¥_3) = 0\) should really just do nothing, hence the empty set will suffice), where the name of each set is \((ğ‘¥_1, ğ‘¥_2, ğ‘¥_3)\).

We now define the reduction function \(f\):

** Inputs **: A set named \((ğ‘¥_1, ğ‘¥_2, ğ‘¥_3)\) and an element, \(a = (ğ‘¥'_1,ğ‘¥_2)\) of a potential subset \(U_{x_1}\).

** Function **: The isomorphism between the VC-DIMENSION instance \((ğ¶,\ell)\) and \(ğ‘„ğ‘†ğ´ğ‘‡_3\) instance \(\varphi(ğ‘¥_1,ğ‘¥_2,ğ‘¥_3)\).

** Deciding Procedure **: We return â€œACCEPTâ€ if \(ğ‘ \in ğ‘†(ğ‘¥_1, ğ‘¥_2, ğ‘¥_3)\) and â€œNOâ€ if \(ğ‘ âˆ‰ ğ‘†(ğ‘¥_1, ğ‘¥_2, ğ‘¥_3)\).

Therefore, we do the following:

If \((\varphi(ğ‘¥_1, ğ‘¥_2, ğ‘¥_3) = 1) âˆ§ (a \in (x_1, \ell))\), return â€œACCEPTâ€.

Else, return â€œREJECTâ€.

Finally, the onus of the proof is to show that â€œyesâ€ instances of \(ğ‘„ğ‘†ğ´ğ‘‡_3\) maps to â€œyesâ€ instances of the VC-
DIMENSION decision problem and vice versa, and that â€œnoâ€ instances of \(ğ‘„ğ‘†ğ´ğ‘‡_3\) maps to â€œnoâ€ instances of the
VC-DIMENSION decision problem and vice versa:

To show that â€œyesâ€ maps to â€œyesâ€:
To show that â€œyesâ€ \(ğ‘„ğ‘†ğ´ğ‘‡_3\) instances map to â€œyesâ€ VC-DIMENSION instances:
Given a â€œyesâ€ instance of \(ğ‘„ğ‘†ğ´ğ‘‡_3\), \(\exist ğ‘¥_1 \forall ğ‘¥_2 \exist ğ‘¥_3 \text{ s.t. } \varphi(ğ‘¥_1, ğ‘¥_2 , ğ‘¥_3 ) = 1\), the set \(ğ‘†(ğ‘¥_1 , ğ‘¥_2 , ğ‘¥_3 ) = \{x_1\}\times x_2\). 
Recall that the initial subset was:
$$ğ‘ˆ_{ğ‘¥_1} =\{ğ‘¥_1\}\times\{1,2,3,...\ell\}$$
However, since \(ğ‘†(ğ‘¥_1, ğ‘¥_2, ğ‘¥_3) = \{ğ‘¥_1\} \times ğ‘¥_2\) and \(\varphi(ğ‘¥_1, ğ‘¥_2, ğ‘¥_3) = 1\), the VC dimension of \(S\) would be \(\geq  ğ‘¥_2 = \ell\).
Hence, the VC dimension of \(S\) that is represented by circuit \(C\) would be \(\geq  \ell\), which satisfies the decision problem.
QED.

To show that â€œyesâ€ VC-DIMENSION instances map to â€œyesâ€ \(ğ‘„ğ‘†ğ´ğ‘‡_3\) instances:
Given a â€œyesâ€ instance of VC-DIMENSION \((ğ¶, ğ‘š)\), then the set \(S\) represented by the circuit \(C\) has a size atleast \(m\).
Therefore, \(\exist ğ‘‹, |ğ‘‹| \geq  ğ‘š \text{ s.t. } ğ‘† \text{ shatters } ğ‘‹\). It follows then by definition of shattering that \(\exist  ğ‘˜ \text{ s.t. } ğ‘‹ \in ğ‘ˆ_ğ‘˜\).
However, this can only happen if \(\forall ğ‘¥_2, {ğ‘¥_1} \times ğ‘¥_2 \in ğ‘†\). This is the same thing as writing:
$$\exist ğ‘¥_1 \forall ğ‘¥_2 \exist ğ‘¥_3 s.t.\phi(ğ‘¥_1,ğ‘¥_2,ğ‘¥_3) = 1,$$
which is a â€œyesâ€ instance of \(ğ‘„ğ‘†ğ´ğ‘‡_3\).
QED.

To show that â€œnoâ€ maps to â€œnoâ€, the contrapositive argument holds since a â€œyesâ€ instance of the VC-DIMENSION problem being reduced to a â€œyesâ€ instance of \(\mathrrm{QSAT}_3\) implies that â€œnoâ€ instances of \(\mathrm{QSAT}_3\) can be reduced to â€œnoâ€ instances of VC-DIMENSION, and a â€œyesâ€ instance of \(\mathrm{QSAT}_3\) being reduced to a â€œyesâ€ instance of VC-DIMENSION implies that a â€œnoâ€ instance of VC-DIMENSION can be reduced to a â€œnoâ€ instance of \(\mathrm{QSAT}_3\).

Since we have shown that â€œyesâ€ maps to â€œyesâ€ and â€œnoâ€ maps to â€œnoâ€, we have that \(\exist \) a reduction function from instances of \(\mathrm{QSAT}_3\) to instances of the VC-DIMENSION problem and that \(\exist \) a reduction function from
instances of the VC-DIMENSION problem to instances of \(ğ‘„ğ‘†ğ´ğ‘‡_3\). Additionally, since \(\mathrm{QSAT}_3\) is known to be \(\Sigma_3^P\)-complete, it follows then that ğ‘‰ğ¶-DIMENSION is also \(\Sigma_3^P\)-complete.
QED.
